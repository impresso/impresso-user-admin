{% extends "admin/base_site.html" %}
{% load i18n admin_urls i18n unfold static %}

{% block breadcrumbs %}{% if not is_popup %}
    <div class="px-4 lg:px-8">
        <div class="container mb-6 mx-auto -my-3 lg:mb-12">
            <ul class="flex flex-wrap">
                {% url 'admin:index' as link %}
                {% trans 'Home' as name %}
                {% include 'unfold/helpers/breadcrumb_item.html' with link=link name=name %}

           
                {% url 'admin:app_list' 'auth' as link %}
                {% trans 'Authentication and Authorization' as name %}
                {% include 'unfold/helpers/breadcrumb_item.html' with link=link name=name %}

                {% url 'admin:auth_user_changelist' as link %}
                {% trans 'Users' as name %}
                {% include 'unfold/helpers/breadcrumb_item.html' with link=link name=name %}
                
                {% url 'admin:auth_user_change' target_user.id as link %}
                {% include 'unfold/helpers/breadcrumb_item.html' with link=link name=target_user.username %}

                {% trans 'Toggle Status' as user_toggle_status_name %}
                {% url 'admin:auth_user_toggle_status' target_user.id as link %}
                {% include 'unfold/helpers/breadcrumb_item.html' with link=link name=user_toggle_status_name %}

            </ul>
        </div>
    </div>
{% endif %}{% endblock %}


{% block content %}
  <h2 class="px-3 mb-4">
    {% if target_user.is_active %}
      Deactivate
    {% else %}
      Activate
    {%endif%} user account
  </h2>
    
  {% component "unfold/components/card.html" with class="lg:w-1/2" %}
    {% component "unfold/components/title.html" %}
      <h1 class="mb-4">
        {{ target_user.first_name }} {{ target_user.last_name }}
      </h1>
    {% endcomponent %}
    {% component "unfold/components/text.html" %}
      <!-- First name, Last Name, email -->
      <div class="mb-3 border-t border-gray-300 pt-3 flex flex-row justify-between">
        <div>
          <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
            First name
          </label>
          <p>
        {{ target_user.first_name }}
          </p>
        </div>
        <div>
          <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
            Last name
          </label>
          <p>
        {{ target_user.last_name }}
          </p>
        </div>
        <div>
          <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
            Email
          </label>
            <a href="{% url 'admin:auth_user_change' target_user.id %}" >
            {{ target_user.email }}
            </a>
        </div>
      </div>
      
      <!-- plans -->
      <div class="mb-3 border-t border-gray-300 pt-3">
        <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
          Plan
        </label>
        {% if target_user.is_active %}
          <p>
            <b>current Plan</b> {{ plan_label }}
          </p>
        {% else %}
          <p>
            as soon as user is active, <b>{{ plan_label }}</b>
          </p>
          <small>To change the default plan, modify the user group list in 
            {% url 'admin:auth_user_change' target_user.id as link %}
            <a href="{{ link }}" class="underline">user detail page</a> 
          </small>
        {% endif %}
      </div>
      

      

      <div class="mb-3 border-t border-gray-300 pt-3">
        <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
          Username
        </label>
        <a href="{% url 'admin:auth_user_change' target_user.id %}">{{ target_user.username }}</a>
      </div>

      <div class="mb-3 border-t border-gray-300 pt-3 flex flex-row justify-between">
        <div>
          <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
            Date joined
          </label>
          {{ target_user.date_joined }}
          </div>
        <div>
          <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
            Last login
          </label>
          {{ target_user.last_login }}
        </div>
      </div>

      <!-- current status -->
      <div class=" border-t border-gray-300 pt-3">
        <label class="block font-semibold mb-2 text-font-important-light text-sm dark:text-font-important-dark required">
          Status
        </label>
        {% if target_user.is_active %}
          <p class="text-green-500">
            <b>Active</b>
          </p>
        {% else %}
          <p class="text-red-500">
            <b>Inactive</b>
          </p>
        {% endif %}
      </div>
      {% endcomponent %}
    {% endcomponent %}
  
  {% if changePlanRequest %}
  <p>
    Change Plan Request: 
    <a href="{% url 'admin:impresso_userchangeplanrequest_change' changePlanRequest.id %}">
      {{ changePlanRequest }}
    </a>
  </p>
    
  {% endif %}

  <form method="post">{% csrf_token %}
    {% if not target_user.is_active %}
    <div class="my-4 flex flex-row gap-5">
      <p>
        <button type="submit" name="activation_mode" value="receipt" class="border border-base-200 font-medium px-3 py-2 rounded transition-all w-full hover:bg-base-50 lg:block lg:w-auto dark:border-base-700  dark:hover:text-base-200 dark:hover:bg-base-900"
        >
            Activate (Send Email)
          </button>
        
        <br>
        <small>This will activate the user and send them a confirmation email.</small>
      </p>
      <p>
        
        <button
        type="submit"
        name="activation_mode" value="silently"
        class="border border-base-200 font-medium px-3 py-2 rounded transition-all w-full hover:bg-base-50 lg:block lg:w-auto dark:border-base-700  dark:hover:text-base-200 dark:hover:bg-base-900"
      >
        Activate (Silently)
      </button>
        <br>
        <small>This will activate the user without notifying them.</small>
      </p>
      </div>    
    {% else %}
      <p>
        <button type="submit" name="activation_mode" value="deactivate" class="border border-base-200 font-medium px-3 py-2 rounded transition-all w-full hover:bg-base-50 lg:block lg:w-auto dark:border-base-700  dark:hover:text-base-200 dark:hover:bg-base-900">
          Deactivate
        </button>
        
      </p>
    {% endif %}
  </form>
{% endblock %}
